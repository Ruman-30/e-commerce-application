paths:
  /payment/verify-payment:
    post:
      summary: Verify Razorpay payment and update order
      tags: [Payment]
      security:
        - bearerAuth: []   # JWT required
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - razorpay_payment_id
                - razorpay_order_id
                - razorpay_signature
                - orderId
              properties:
                razorpay_payment_id:
                  type: string
                  example: pay_Jl2d3sR4gk2xE8
                razorpay_order_id:
                  type: string
                  example: order_Jl2a9pQ3vH7d9f
                razorpay_signature:
                  type: string
                  example: 5a1d3afc6d96b6d78c78b32a73b832f8a9e43d87c7e8
                orderId:
                  type: string
                  example: 64f2a7b5c1a23a001f5d9b20
      responses:
        "200":
          description: Payment verified and order updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Payment verified, order updated & confirmation email sent.
                  order:
                    $ref: "#/components/schemas/Order"
        "400":
          description: Bad request (verification failed, order mismatch, already paid, etc.)
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    examples:
                      verificationFailed:
                        value: Payment verification failed!
                      mismatch:
                        value: Order ID mismatch!
                      alreadyPaid:
                        value: Payment already processed for this order.
        "404":
          description: Order not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Order not found.
        "401":
          description: Unauthorized (missing or invalid token)
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Unauthorized. Please log in.
        "500":
          description: Server error while verifying payment
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Error verifying payment
                  error:
                    type: string
